# Malware classification/detection using ML 

## <=================Project: staticFeatures=================>


In this project, I used different static features obtained from the malware binaries (PE files) to classify/detect (Benign or Malware) malware.

1. resource_extractor.py is used to extract different static features from the malware binaries and benign binaries(Dataset - dataset.csv).
  
  i. Extracted features:    md5|Machine|SizeOfOptionalHeader|Characteristics|MajorLinkerVersion|MinorLinkerVersion|SizeOfCode|SizeOfInitializedData|SizeOfUninitializedData|AddressOfEntryPoint|BaseOfCode|BaseOfData|ImageBase|SectionAlignment|FileAlignment|MajorOperatingSystemVersion|MinorOperatingSystemVersion|MajorImageVersion|MinorImageVersion|MajorSubsystemVersion|MinorSubsystemVersion|SizeOfImage|SizeOfHeaders|CheckSum|Subsystem|DllCharacteristics|SizeOfStackReserve|SizeOfStackCommit|SizeOfHeapReserve|SizeOfHeapCommit|LoaderFlags|NumberOfRvaAndSizes|SectionsNb|SectionsMeanEntropy|SectionsMinEntropy|SectionsMaxEntropy|SectionsMeanRawsize|SectionsMinRawsize|SectionMaxRawsize|SectionsMeanVirtualsize|SectionsMinVirtualsize|SectionMaxVirtualsize|ImportsNbDLL|ImportsNb|ImportsNbOrdinal|ExportNb|ResourcesNb|ResourcesMeanEntropy|ResourcesMinEntropy|ResourcesMaxEntropy|ResourcesMeanSize|ResourcesMinSize|ResourcesMaxSize|LoadConfigurationSize|VersionInformationSize|legitimate
  
  ii. legitimate column indicates the label for the binaries.

2. After feature selection following features were used:
  
  a. Machine
  
  b. MajorOperatingSystemVersion
  
  c. MajorSubsystemVersion
  
  d. SizeOfOptionalHeader
  
  e. DllCharacteristics
  
  f. VersionInformationSize
  
  g. Characteristics
  
  h. LoadConfigurationSize
  
  i. ResourcesMaxEntropy
  
  j. ImageBase
  
  k. ImportsNbDLL

3. Training-test split: 80% - 20%
4. ML Algorithms:
  
  a. KNeighbors: Accuracy: 0.97 
  
  b. RandomForest Accuracy: 0.98
  
  c. XGBoost: Accuracy: 0.98 
  
  d. SVM: Accuracy: 0.96 (for details result look into the jupyter notebook inside staticFeatures folder)

 

## <=================Project: PE2Image=================>


The objective of this project is to classify different malware into different families. TO do so, I converted malware PE files into images. Convolutional Neural Network model is used to perform the classification. 

1. How to convert the malware into images: For each file, the raw data contains the hexadecimal representation of the file's binary content. The goal is to convert those files into PNG images (please look into the notebook file).

![image](https://user-images.githubusercontent.com/30213560/109460790-2b185a80-7a2f-11eb-8f00-559121e4bc8b.png) 
becomes
![image](https://user-images.githubusercontent.com/30213560/109460826-3b303a00-7a2f-11eb-9c98-3a828a00f781.png)

2. However, to avoid building dataset and time, I will not create my own dataset and I will use the Malming dataset in which Malwares are already set to images. https://www.dropbox.com/s/ep8qjakfwh1rzk4/malimg_dataset.zip?dl=0
3. The dataset has images from 25 families. 
4. For classification, I used Convolutional Neural Network(CNN)
5. since the dataset is imbalanced, I used class_weight to assign higher weight to minority class and lower weight to majority class.
6. Overall accuracy: 96% ((for details result look into the jupyter notebook inside PE2Image folder)



## TO Do:
1. Opcode based malware detection/classification
2. Static API based malware detection/classification
3. Static API based malware detection/classification
